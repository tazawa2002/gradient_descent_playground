<!DOCTYPE html>

<html lang="ja">
    <head>
        <title> 勾配法の可視化 </title>
        <script src="./optimizer.js"></script>
        <script src="./visualizer.js"></script>
        <script src="./gd.js"></script>
    </head>
    <body>
        <h1> 勾配法の可視化 </h1>

        <!-- ヒートマップ -->
        <div id="heatmap"> </div>

        <!-- step数 -->
        <div id="stepCount">Step Count: 0</div>

        <!-- ハイパーパラメーター設定フォーム -->
        <div id="config">

            <label for="functionType">Function Type:</label>
            <select id="functionType">
                <option value="rosenbrock">Rosenbrock</option>
            </select>

            <label for="optimizer">Optimizer:</label>
            <select id="optimizer">
                <option value="normal">Normal</option>
                <option value="momentum">Momentum</option>
                <option value="nesterov">Nesterov</option>
                <option value="metropolis">Metropolis</option>
                <option value="newtonraphson">Newton-Raphson</option>
            </select>
            <br>

            <div id="hypperparameters">
                <label for="learningRate">Learning Rate:</label>
                <input type="number" id="learningRate" value="0.001" step="0.0001">
                <br>

                <label for="momentum">Momentum:</label>
                <input type="number" id="momentum" value="0.9" step="0.1">
                <br>
            </div>

            <label for="initialX">Initial X:</label>
            <input type="number" id="initialX" value="-1.5" step="0.1">
            <br>

            <label for="initialY">Initial Y:</label>
            <input type="number" id="initialY" value="1.5" step="0.1">
            <br>

            <label for="speedRange">Speed:</label>
            <input type="range" id="speedRange" min="10" max="1000" step="10" value="50">
            <span id="speedValue">50</span> step/s
            <br>

            <button id="startButton">Start Optimization</button>
            <button id="stopButton">Stop Optimization</button>
        </div>

        <!-- Canvas -->
        <canvas id="heatmapCanvas" width="500" height="500"></canvas>

        <script>
            // 最適化
            document.getElementById('startButton').addEventListener('click', () => {
                // ユーザー入力を取得
                const functionType = document.getElementById('functionType').value;
                const optimizerType = document.getElementById('optimizer').value;
                const learningRate = parseFloat(document.getElementById('learningRate').value);
                const momentum = parseFloat(document.getElementById('momentum').value);
                const initialX = parseFloat(document.getElementById('initialX').value);
                const initialY = parseFloat(document.getElementById('initialY').value);
                const speed = parseInt(document.getElementById('speedRange').value, 10);

                // gd.js の関数を呼び出して最適化を開始
                startOptimization(functionType, optimizerType, initialX, initialY, speed);
            });

            document.getElementById('stopButton').addEventListener('click', () => {
                // gd.js の関数を呼び出して最適化を停止
                stopOptimization();
            });

            document.getElementById('speedRange').addEventListener('input', (event) => {
                const speedValue = event.target.value;
                document.getElementById('speedValue').textContent = speedValue;
                setSpeed(speedValue);
            });

            document.getElementById('learningRate').addEventListener('input', (event) => {
                const learningRate = event.target.value;
                setLearningRate(learningRate);
            });
            document.getElementById('momentum').addEventListener('input', (event) => {
                const momentum = event.target.value;
                setMomentum(momentum);
            });

            
        </script>
    </body>
</html>